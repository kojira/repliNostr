<!doctype html>
<html lang="en">
    <head>
      <style data-vite-theme="" data-inject-first="">:root {
      --background: 0 0% 100%;
--foreground: 20 14.3% 4.1%;
--muted: 60 4.8% 95.9%;
--muted-foreground: 25 5.3% 44.7%;
--popover: 0 0% 100%;
--popover-foreground: 20 14.3% 4.1%;
--card: 0 0% 100%;
--card-foreground: 20 14.3% 4.1%;
--border: 20 5.9% 90%;
--input: 20 5.9% 90%;
--primary: 222 47% 11%;
--primary-foreground: 221 8% 97%;
--secondary: 60 4.8% 95.9%;
--secondary-foreground: 24 9.8% 10%;
--accent: 60 4.8% 95.9%;
--accent-foreground: 24 9.8% 10%;
--destructive: 0 84.2% 60.2%;
--destructive-foreground: 60 9.1% 97.8%;
--ring: 20 14.3% 4.1%;
--radius: 0.5rem;
  }
  .dark {
      --background: 240 10% 3.9%;
--foreground: 0 0% 98%;
--muted: 240 3.7% 15.9%;
--muted-foreground: 240 5% 64.9%;
--popover: 240 10% 3.9%;
--popover-foreground: 0 0% 98%;
--card: 240 10% 3.9%;
--card-foreground: 0 0% 98%;
--border: 240 3.7% 15.9%;
--input: 240 3.7% 15.9%;
--primary: 222 47% 11%;
--primary-foreground: 221 8% 97%;
--secondary: 240 3.7% 15.9%;
--secondary-foreground: 0 0% 98%;
--accent: 240 3.7% 15.9%;
--accent-foreground: 0 0% 98%;
--destructive: 0 62.8% 30.6%;
--destructive-foreground: 0 0% 98%;
--ring: 240 4.9% 83.9%;
--radius: 0.5rem;
  }</style>

        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Nostr Client</title>
        <link rel="manifest" href="manifest.json" />
        <script>
            // GitHub Pages用の設定
            (function() {
                const isGitHubPages = window.location.hostname.includes('github.io');
                const baseUrl = isGitHubPages ? '/repliNostr/' : '/';  // 末尾のスラッシュを含める

                console.log('[index] Initial state:', {
                    isGitHubPages,
                    baseUrl,
                    currentUrl: window.location.href,
                    pathname: window.location.pathname,
                    origin: window.location.origin
                });

                // baseタグを動的に設定
                const base = document.createElement('base');
                base.href = baseUrl;
                document.head.prepend(base);
                console.log('[index] Set base href:', base.href);

                // 404.htmlからのリダイレクト処理
                const redirect = sessionStorage.redirect;
                if (redirect) {
                    console.log('[index] Found redirect in sessionStorage:', {
                        redirect,
                        currentPath: window.location.pathname
                    });
                    delete sessionStorage.redirect;

                    try {
                        // パスの取得とクエリ・ハッシュの保持
                        const url = new URL(redirect);
                        console.log('[index] Parsed redirect URL:', {
                            fullUrl: url.toString(),
                            pathname: url.pathname,
                            search: url.search,
                            hash: url.hash
                        });

                        // baseUrlより後ろのパスを抽出
                        let finalPath = url.pathname;
                        if (finalPath.startsWith(baseUrl)) {
                            finalPath = finalPath.slice(baseUrl.length);
                            console.log('[index] Sliced base URL from path:', {
                                originalPath: url.pathname,
                                baseUrl,
                                finalPath
                            });
                        }

                        // パスを正規化
                        finalPath = '/' + finalPath.replace(/^\/+/, '') + url.search + url.hash;
                        console.log('[index] Normalized final path:', finalPath);

                        // 状態を更新
                        history.replaceState(null, '', finalPath);
                        console.log('[index] Updated history state with path:', finalPath);
                    } catch (error) {
                        console.error('[index] Error processing redirect:', error);
                    }
                } else {
                    console.log('[index] No redirect found in sessionStorage');
                }

                // 環境変数の設定
                window.__ENV = {
                    BASE_URL: baseUrl,
                    ASSET_URL: `${baseUrl}assets/`
                };
                console.log('[index] Set environment variables:', window.__ENV);
            })();
        </script>
      <script type="module" crossorigin src="/repliNostr/assets/index-DYDg0GYr.js"></script>
      <link rel="stylesheet" crossorigin href="/repliNostr/assets/index-BpeqVgwZ.css">
    </head>
    <body class="min-h-screen bg-background font-sans antialiased">
        <div id="root"></div>
    </body>
</html>